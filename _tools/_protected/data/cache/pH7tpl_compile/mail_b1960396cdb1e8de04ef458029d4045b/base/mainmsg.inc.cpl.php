<?php 
namespace PH7;
defined('PH7') or exit('Restricted access');
/*
Created on 2020-04-04 04:34:17
Compiled file from: C:\xampp\htdocs\ph7\_protected\app/system/modules/mail\views/base\tpl\main\msg.inc.tpl
Template Engine: PH7Tpl version 1.4.0 by Pierre-Henry Soria
*/
/***************************************************************************
 *     pH7CMS Web Engineer: Pierre-Henry Soria
 *               --------------------
 * @since      Mon Mar 21 2011
 * @author     Pierre-Henry Soria
 * @email      hello@ph7cms.com
 * @link       https://ph7cms.com
 * @copyright  (c) 2011-2020, Pierre-Henry Soria. All Rights Reserved.
 * @license    Creative Commons Attribution 3.0 License - http://creativecommons.org/licenses/by/3.0/
 ***************************************************************************/
?><div class="msg-menu"> <a href="<?php $design->url('mail','main','compose') ;?>">Compose</a> | <a href="<?php $design->url('mail','main','inbox') ;?>">Inbox(<?php echo $count_unread_mail; ?>) </a> | <a href="<?php $design->url('mail','main','outbox') ;?>">Sent</a> | <a href="<?php $design->url('mail','main','trash') ;?>">Trash</a> | <a href="<?php $design->url('user','setting','index') ;?>#p=notification">Settings</a> |</div><?php if(empty($msg)) { ?> <p class="bold center"> <?php echo t('That message was not found.'); ?> </p><?php } else { ?> <?php $usernameSender = (empty($msg->username)) ? PH7_ADMIN_USERNAME : escape($msg->username) ;?> <?php $firstNameSender = (empty($msg->firstName)) ? PH7_ADMIN_USERNAME : escape($msg->firstName) ;?> <?php $subject = escape(Framework\Security\Ban\Ban::filterWord($msg->title)) ;?> <?php $message = Framework\Parse\Emoticon::init(Framework\Security\Ban\Ban::filterWord($msg->message)) ;?> <?php $is_outbox = ($msg->sender == $member_id) ;?> <?php $is_trash = (($msg->sender == $member_id && $msg->trash == 'sender') || ($msg->recipient == $member_id && $msg->trash == 'recipient') && !$is_outbox) ;?> <?php $is_delete = ($is_outbox || $is_trash) ;?> <?php $set_to = ($is_delete) ? 'setdelete' : 'settrash' ;?> <?php $label_txt = ($is_delete) ? t('Delete') : t('Trash') ;?> <?php $subject = escape(str_replace('re ', '', $msg->title), true) ;?> <div class="left"> <dl> <dt class="msg-label"><?php echo t('From:'); ?></dt> <dd><?php $avatarDesign->get($usernameSender, $firstNameSender, null, 32) ;?></dd> <dd class="msg-from"><?php echo $usernameSender ?></dd> <dt class="msg-label"><?php echo t('Subject:'); ?></dt> <dd class="msg-cc"><?php echo $subject; ?></dd> </dl> <?php if(!empty($msgsOld)) { ?> <h6>Previous Messages:</h6> <?php foreach($msgsOld as $msg) { ?> <?php $usernameSender = (empty($msg->username)) ? PH7_ADMIN_USERNAME : escape($msg->username) ;?> <?php $firstNameSender = (empty($msg->firstName)) ? PH7_ADMIN_USERNAME : escape($msg->firstName) ;?> <?php $subject = escape(Framework\Security\Ban\Ban::filterWord($msg->title)) ;?> <?php $message = Framework\Parse\Emoticon::init(Framework\Security\Ban\Ban::filterWord($msg->message)) ;?> <?php $is_outbox = ($msg->sender == $member_id) ;?> <?php $is_trash = (($msg->sender == $member_id && $msg->trash == 'sender') || ($msg->recipient == $member_id && $msg->trash == 'recipient') && !$is_outbox) ;?> <?php $is_delete = ($is_outbox || $is_trash) ;?> <?php $set_to = 'setdelete' ;?> <?php $label_txt = t('Delete') ;?> <?php $subject = escape(str_replace('re ', '', $msg->title), true) ;?> <div class="msg-left"> <dl> <dd class="msg-text-area"><?php echo $message; ?></dd> <div><?php LinkCoreForm::display($label_txt, 'mail', 'main', $set_to, array('id'=>$msg->messageId)) ;?> <?php if($is_trash) { ?> | <?php LinkCoreForm::display(t('Move to Inbox'), 'mail', 'main', 'setrestore', array('id'=>$msg->messageId)) ;?><?php } ?></div> <?php if($msg->sender === $member_id) { ?> <dt class="msg-l-sent">Sent: &nbsp;<?php echo Framework\Date\Various::textTimeStamp($msg->sendDate) ;?></dt> <?php } else { ?> <dt class="msg-l-received">Received: &nbsp;<?php echo Framework\Date\Various::textTimeStamp($msg->sendDate) ;?></dt> <?php } ?> </dl> <?php } ?> <?php } ?> <hr> <?php MailForm::display() ;?> </div><?php } ?>